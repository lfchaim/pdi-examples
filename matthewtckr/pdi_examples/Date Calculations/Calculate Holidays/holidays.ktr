<?xml version="1.0" encoding="UTF-8"?>
<transformation>
  <info>
    <name>holidays</name>
    <description/>
    <extended_description/>
    <trans_version/>
    <trans_type>Normal</trans_type>
    <directory>&#x2f;</directory>
    <parameters>
    </parameters>
    <log>
<trans-log-table><connection/>
<schema/>
<table/>
<size_limit_lines/>
<interval/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field><field><id>TRANSNAME</id><enabled>Y</enabled><name>TRANSNAME</name></field><field><id>STATUS</id><enabled>Y</enabled><name>STATUS</name></field><field><id>LINES_READ</id><enabled>Y</enabled><name>LINES_READ</name><subject/></field><field><id>LINES_WRITTEN</id><enabled>Y</enabled><name>LINES_WRITTEN</name><subject/></field><field><id>LINES_UPDATED</id><enabled>Y</enabled><name>LINES_UPDATED</name><subject/></field><field><id>LINES_INPUT</id><enabled>Y</enabled><name>LINES_INPUT</name><subject/></field><field><id>LINES_OUTPUT</id><enabled>Y</enabled><name>LINES_OUTPUT</name><subject/></field><field><id>LINES_REJECTED</id><enabled>Y</enabled><name>LINES_REJECTED</name><subject/></field><field><id>ERRORS</id><enabled>Y</enabled><name>ERRORS</name></field><field><id>STARTDATE</id><enabled>Y</enabled><name>STARTDATE</name></field><field><id>ENDDATE</id><enabled>Y</enabled><name>ENDDATE</name></field><field><id>LOGDATE</id><enabled>Y</enabled><name>LOGDATE</name></field><field><id>DEPDATE</id><enabled>Y</enabled><name>DEPDATE</name></field><field><id>REPLAYDATE</id><enabled>Y</enabled><name>REPLAYDATE</name></field><field><id>LOG_FIELD</id><enabled>Y</enabled><name>LOG_FIELD</name></field><field><id>EXECUTING_SERVER</id><enabled>N</enabled><name>EXECUTING_SERVER</name></field><field><id>EXECUTING_USER</id><enabled>N</enabled><name>EXECUTING_USER</name></field><field><id>CLIENT</id><enabled>N</enabled><name>CLIENT</name></field></trans-log-table>
<perf-log-table><connection/>
<schema/>
<table/>
<interval/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>SEQ_NR</id><enabled>Y</enabled><name>SEQ_NR</name></field><field><id>LOGDATE</id><enabled>Y</enabled><name>LOGDATE</name></field><field><id>TRANSNAME</id><enabled>Y</enabled><name>TRANSNAME</name></field><field><id>STEPNAME</id><enabled>Y</enabled><name>STEPNAME</name></field><field><id>STEP_COPY</id><enabled>Y</enabled><name>STEP_COPY</name></field><field><id>LINES_READ</id><enabled>Y</enabled><name>LINES_READ</name></field><field><id>LINES_WRITTEN</id><enabled>Y</enabled><name>LINES_WRITTEN</name></field><field><id>LINES_UPDATED</id><enabled>Y</enabled><name>LINES_UPDATED</name></field><field><id>LINES_INPUT</id><enabled>Y</enabled><name>LINES_INPUT</name></field><field><id>LINES_OUTPUT</id><enabled>Y</enabled><name>LINES_OUTPUT</name></field><field><id>LINES_REJECTED</id><enabled>Y</enabled><name>LINES_REJECTED</name></field><field><id>ERRORS</id><enabled>Y</enabled><name>ERRORS</name></field><field><id>INPUT_BUFFER_ROWS</id><enabled>Y</enabled><name>INPUT_BUFFER_ROWS</name></field><field><id>OUTPUT_BUFFER_ROWS</id><enabled>Y</enabled><name>OUTPUT_BUFFER_ROWS</name></field></perf-log-table>
<channel-log-table><connection/>
<schema/>
<table/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field><field><id>LOG_DATE</id><enabled>Y</enabled><name>LOG_DATE</name></field><field><id>LOGGING_OBJECT_TYPE</id><enabled>Y</enabled><name>LOGGING_OBJECT_TYPE</name></field><field><id>OBJECT_NAME</id><enabled>Y</enabled><name>OBJECT_NAME</name></field><field><id>OBJECT_COPY</id><enabled>Y</enabled><name>OBJECT_COPY</name></field><field><id>REPOSITORY_DIRECTORY</id><enabled>Y</enabled><name>REPOSITORY_DIRECTORY</name></field><field><id>FILENAME</id><enabled>Y</enabled><name>FILENAME</name></field><field><id>OBJECT_ID</id><enabled>Y</enabled><name>OBJECT_ID</name></field><field><id>OBJECT_REVISION</id><enabled>Y</enabled><name>OBJECT_REVISION</name></field><field><id>PARENT_CHANNEL_ID</id><enabled>Y</enabled><name>PARENT_CHANNEL_ID</name></field><field><id>ROOT_CHANNEL_ID</id><enabled>Y</enabled><name>ROOT_CHANNEL_ID</name></field></channel-log-table>
<step-log-table><connection/>
<schema/>
<table/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field><field><id>LOG_DATE</id><enabled>Y</enabled><name>LOG_DATE</name></field><field><id>TRANSNAME</id><enabled>Y</enabled><name>TRANSNAME</name></field><field><id>STEPNAME</id><enabled>Y</enabled><name>STEPNAME</name></field><field><id>STEP_COPY</id><enabled>Y</enabled><name>STEP_COPY</name></field><field><id>LINES_READ</id><enabled>Y</enabled><name>LINES_READ</name></field><field><id>LINES_WRITTEN</id><enabled>Y</enabled><name>LINES_WRITTEN</name></field><field><id>LINES_UPDATED</id><enabled>Y</enabled><name>LINES_UPDATED</name></field><field><id>LINES_INPUT</id><enabled>Y</enabled><name>LINES_INPUT</name></field><field><id>LINES_OUTPUT</id><enabled>Y</enabled><name>LINES_OUTPUT</name></field><field><id>LINES_REJECTED</id><enabled>Y</enabled><name>LINES_REJECTED</name></field><field><id>ERRORS</id><enabled>Y</enabled><name>ERRORS</name></field><field><id>LOG_FIELD</id><enabled>N</enabled><name>LOG_FIELD</name></field></step-log-table>
<metrics-log-table><connection/>
<schema/>
<table/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field><field><id>LOG_DATE</id><enabled>Y</enabled><name>LOG_DATE</name></field><field><id>METRICS_DATE</id><enabled>Y</enabled><name>METRICS_DATE</name></field><field><id>METRICS_CODE</id><enabled>Y</enabled><name>METRICS_CODE</name></field><field><id>METRICS_DESCRIPTION</id><enabled>Y</enabled><name>METRICS_DESCRIPTION</name></field><field><id>METRICS_SUBJECT</id><enabled>Y</enabled><name>METRICS_SUBJECT</name></field><field><id>METRICS_TYPE</id><enabled>Y</enabled><name>METRICS_TYPE</name></field><field><id>METRICS_VALUE</id><enabled>Y</enabled><name>METRICS_VALUE</name></field></metrics-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file/>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
         <slaveserver><name>zendesk-bi-51</name><hostname>zendesk-bi.pentaho.com</hostname><port>9080</port><webAppName>pentaho-di</webAppName><username>admin</username><password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password><proxy_hostname/><proxy_port/><non_proxy_hosts/><master>Y</master></slaveserver>
    </slaveservers>
    <clusterschemas>
        <clusterschema>
          <name>YarnCluster</name>
          <base_port>4000</base_port>
          <sockets_buffer_size>2000</sockets_buffer_size>
          <sockets_flush_interval>5000</sockets_flush_interval>
          <sockets_compressed>N</sockets_compressed>
          <dynamic>N</dynamic>
          <slaveservers>
          </slaveservers>
        </clusterschema>
    </clusterschemas>
  <created_user>-</created_user>
  <created_date>2014&#x2f;02&#x2f;13 10&#x3a;14&#x3a;42.333</created_date>
  <modified_user>-</modified_user>
  <modified_date>2014&#x2f;02&#x2f;13 10&#x3a;14&#x3a;42.333</modified_date>
  </info>
  <notepads>
    <notepad>
      <note>For a given input year, calculate major holidays in that year.&#xd;&#xa;&#xd;&#xa;Supports the ability for fixed dates &#x28;Christmas&#x3a; December 25&#x29; as well as relative dates &#x28;Thanksgiving&#x3a; 4th Thursday of November&#x29;</note>
      <xloc>48</xloc>
      <yloc>64</yloc>
      <width>750</width>
      <heigth>56</heigth>
      <fontname>Arial</fontname>
      <fontsize>10</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
  </notepads>
  <order>
  <hop> <from>Generate Years</from><to>Calculate Holidays For Year</to><enabled>Y</enabled> </hop>
  <hop> <from>Calculate Holidays For Year</from><to>Row Normaliser</to><enabled>Y</enabled> </hop>
  </order>
  <step>
    <name>Calculate Holidays For Year</name>
    <type>UserDefinedJavaClass</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>

    <definitions>
        <definition>
        <class_type>TRANSFORM_CLASS</class_type>

        <class_name>Processor</class_name>

        <class_source><![CDATA[//Based upon http://stackoverflow.com/a/1047411/1103962
//Distributed under the CC-BY-SA license (http://creativecommons.org/licenses/by-sa/2.5/)

import java.util.ArrayList;
import java.util.Calendar;
import java.util.Date;
import java.util.GregorianCalendar;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import org.apache.commons.lang.time.DateUtils;

public boolean processRow(StepMetaInterface smi, StepDataInterface sdi) throws KettleException
{
    // First, get a row from the default input hop
    Object[] r = getRow();

    // If the row object is null, we are done processing.
    if (r == null) {
      setOutputDone();
      return false;
    }

    int yearField = getInputRowMeta().indexOfValue(getParameter("YEAR_FIELD"));
    if (yearField<0) {
        throw new KettleException("Year field not found in the input row, check parameter 'YEAR_FIELD'");
    }
    int year = getInputRowMeta().getInteger(r, yearField).intValue();

    // It is always safest to call createOutputRow() to ensure that your output row's Object[] is large
    // enough to handle any new fields you are creating in this step.
    Object[] outputRow = createOutputRow(r, data.outputRowMeta.size());

    // Set the value in the output field
    Calendar baseCalendar = GregorianCalendar.getInstance();
    baseCalendar.clear();

    //New Years day
    baseCalendar.set(year, Calendar.JANUARY, 1);
    Date Holiday_NewYearsDay = offsetForWeekend(baseCalendar);

    //Martin Luther King Day 
     Date Holiday_MartinLutherKingJrDay = calculateFloatingHoliday(3, Calendar.MONDAY, year, Calendar.JANUARY);

    //Presidents Day
    Date Holiday_PresidentsDay = calculateFloatingHoliday(3, Calendar.MONDAY, year, Calendar.FEBRUARY);

    //Memorial Day
    Date Holiday_MemorialDay = calculateFloatingHoliday(0, Calendar.MONDAY, year, Calendar.MAY);

    //Independence Day
    baseCalendar.set(year, Calendar.JULY, 4);
    Date Holiday_IndependenceDay = offsetForWeekend(baseCalendar);

    //Labor Day
    Date Holiday_LaborDay = calculateFloatingHoliday(1, Calendar.MONDAY, year, Calendar.SEPTEMBER);

    //Columbus Day
    Date Holiday_ColumbusDay = calculateFloatingHoliday(2, Calendar.MONDAY, year, Calendar.OCTOBER);

    //Veterans Day
    baseCalendar.set(year, Calendar.NOVEMBER, 11);
    Date Holiday_VeteransDay = offsetForWeekend(baseCalendar);

    //Thanksgiving Day and Thanksgiving Friday
    Date Holiday_ThanksgivingDay = calculateFloatingHoliday(4, Calendar.THURSDAY, year, Calendar.NOVEMBER);;
    Date Holiday_DayAfterThanksgivingDay = addDays(Holiday_ThanksgivingDay, 1);

    //Christmas
    baseCalendar.set(year, Calendar.DECEMBER, 25);
    Date Holiday_ChristmasDay = offsetForWeekend(baseCalendar);


    get(Fields.Out, getParameter("OUTFIELD_NEWYEARSDAY")).setValue(outputRow, Holiday_NewYearsDay);
    get(Fields.Out, getParameter("OUTFIELD_MARTINLUTHERKINGDAY")).setValue(outputRow, Holiday_MartinLutherKingJrDay);
    get(Fields.Out, getParameter("OUTFIELD_PRESIDENTSDAY")).setValue(outputRow, Holiday_PresidentsDay);
    get(Fields.Out, getParameter("OUTFIELD_MEMORIALDAY")).setValue(outputRow, Holiday_MemorialDay);
    get(Fields.Out, getParameter("OUTFIELD_INDEPENDENCEDAY")).setValue(outputRow, Holiday_IndependenceDay);
    get(Fields.Out, getParameter("OUTFIELD_LABORDAY")).setValue(outputRow, Holiday_LaborDay);
    get(Fields.Out, getParameter("OUTFIELD_COLUMBUSDAY")).setValue(outputRow, Holiday_ColumbusDay);
    get(Fields.Out, getParameter("OUTFIELD_VETERANSDAY")).setValue(outputRow, Holiday_VeteransDay);
    get(Fields.Out, getParameter("OUTFIELD_THANKSGIVINGDAY")).setValue(outputRow, Holiday_ThanksgivingDay);
    get(Fields.Out, getParameter("OUTFIELD_DAYAFTERTHANKSGIVINGDAY")).setValue(outputRow, Holiday_DayAfterThanksgivingDay);
    get(Fields.Out, getParameter("OUTFIELD_CHRISTMASDAY")).setValue(outputRow, Holiday_ChristmasDay);

    // putRow will send the row on to the default output hop.
    //
    putRow(data.outputRowMeta, outputRow);

    return true;
}

/**
 * This method will take in the various parameters and return a Date objet
 * that represents that value. 
 * 
 * Ex. To get Martin Luther Kings BDay, which is the 3rd Monday of January, 
 * the method call woudl be:
 * 
 * calculateFloatingHoliday(3, Calendar.MONDAY, year, Calendar.JANUARY);
 * 
 * Reference material can be found at: 
 * http://michaelthompson.org/technikos/holidays.php#MemorialDay
 * 
 * @param nth 0 for Last, 1 for 1st, 2 for 2nd, etc. 
 * @param dayOfWeek Use Calendar.MODAY, Calendar.TUESDAY, etc. 
 * @param year 
 * @param month Use Calendar.JANUARY, etc. 
 * @return
 */
private Date calculateFloatingHoliday(int nth, int dayOfWeek, int year, int month)
{
    Calendar baseCal = Calendar.getInstance();
    baseCal.clear();

    //Determine what the very earliest day this could occur.
    //If the value was 0 for the nth parameter, incriment to the following
    //month so that it can be subtracted alter. 
    baseCal.set(year, month + ((nth <= 0) ? 1 : 0), 1);
    Date baseDate = baseCal.getTime();

    //Figure out which day of the week that this "earliest" could occur on 
    //and then determine what the offset is for our day that we actually need. 
    int baseDayOfWeek = baseCal.get(Calendar.DAY_OF_WEEK);
    int fwd = dayOfWeek - baseDayOfWeek;

    //Based on the offset and the nth parameter, we are able to determine the offset of days and then 
    //adjust our base date. 
    return addDays(baseDate, (fwd + (nth - (fwd >= 0 ? 1 : 0)) * 7));
}

/*
 * If the given date falls on a weekend, the
 * method will adjust to the closest weekday.
 * I.E. If the date is on a Saturday, then the Friday
 * will be returned, if it's a Sunday, then Monday 
 * is returned.  
 */
private Date offsetForWeekend(Calendar baseCal)
{
    Date returnDate = baseCal.getTime();
    if (baseCal.get(Calendar.DAY_OF_WEEK) == Calendar.SATURDAY)
    {
        logDebug("Offsetting the Saturday by -1: " + returnDate);
        return addDays(returnDate, -1);
    } else if (baseCal.get(Calendar.DAY_OF_WEEK) == Calendar.SUNDAY)
    {
        logDebug("Offsetting the Sunday by +1: " + returnDate);
        return addDays(returnDate, 1);
    } else
        return returnDate;
}

/**
 * Private method simply adds 
 * @param dateToAdd
 * @param numberOfDay
 * @return
 */
private Date addDays(Date dateToAdd, int numberOfDay)
{
    if (dateToAdd == null)
        throw new IllegalArgumentException("Date can't be null!");
    Calendar tempCal = Calendar.getInstance();
    tempCal.setTime(dateToAdd);
    tempCal.add(Calendar.DATE, numberOfDay);
    return tempCal.getTime();
}]]></class_source>
        </definition>
    </definitions>
    <fields>
        <field>
        <field_name>Holiday_NewYearsDay</field_name>

        <field_type>Date</field_type>

        <field_length>-1</field_length>

        <field_precision>-1</field_precision>

        </field>
        <field>
        <field_name>Holiday_MartinLutherKingJrDay</field_name>

        <field_type>Date</field_type>

        <field_length>-1</field_length>

        <field_precision>-1</field_precision>

        </field>
        <field>
        <field_name>Holiday_PresidentsDay</field_name>

        <field_type>Date</field_type>

        <field_length>-1</field_length>

        <field_precision>-1</field_precision>

        </field>
        <field>
        <field_name>Holiday_MemorialDay</field_name>

        <field_type>Date</field_type>

        <field_length>-1</field_length>

        <field_precision>-1</field_precision>

        </field>
        <field>
        <field_name>Holiday_IndependenceDay</field_name>

        <field_type>Date</field_type>

        <field_length>-1</field_length>

        <field_precision>-1</field_precision>

        </field>
        <field>
        <field_name>Holiday_LaborDay</field_name>

        <field_type>Date</field_type>

        <field_length>-1</field_length>

        <field_precision>-1</field_precision>

        </field>
        <field>
        <field_name>Holiday_ColumbusDay</field_name>

        <field_type>Date</field_type>

        <field_length>-1</field_length>

        <field_precision>-1</field_precision>

        </field>
        <field>
        <field_name>Holiday_VeteransDay</field_name>

        <field_type>Date</field_type>

        <field_length>-1</field_length>

        <field_precision>-1</field_precision>

        </field>
        <field>
        <field_name>Holiday_ThanksgivingDay</field_name>

        <field_type>Date</field_type>

        <field_length>-1</field_length>

        <field_precision>-1</field_precision>

        </field>
        <field>
        <field_name>Holiday_DayAfterThanksgivingDay</field_name>

        <field_type>Date</field_type>

        <field_length>-1</field_length>

        <field_precision>-1</field_precision>

        </field>
        <field>
        <field_name>Holiday_ChristmasDay</field_name>

        <field_type>Date</field_type>

        <field_length>-1</field_length>

        <field_precision>-1</field_precision>

        </field>
    </fields><clear_result_fields>N</clear_result_fields>
<info_steps></info_steps><target_steps></target_steps><usage_parameters><usage_parameter><parameter_tag>YEAR_FIELD</parameter_tag>
<parameter_value>year</parameter_value>
<parameter_description>The field that contains the year</parameter_description>
</usage_parameter><usage_parameter><parameter_tag>OUTFIELD_NEWYEARSDAY</parameter_tag>
<parameter_value>Holiday_NewYearsDay</parameter_value>
<parameter_description>The name of the output field which will store the date for New Years Day</parameter_description>
</usage_parameter><usage_parameter><parameter_tag>OUTFIELD_MARTINLUTHERKINGDAY</parameter_tag>
<parameter_value>Holiday_MartinLutherKingJrDay</parameter_value>
<parameter_description>The name of the output field which will store the date for Martin Luther King Jr. Day</parameter_description>
</usage_parameter><usage_parameter><parameter_tag>OUTFIELD_PRESIDENTSDAY</parameter_tag>
<parameter_value>Holiday_PresidentsDay</parameter_value>
<parameter_description>The name of the output field which will store the date for President&#x27;s Day</parameter_description>
</usage_parameter><usage_parameter><parameter_tag>OUTFIELD_MEMORIALDAY</parameter_tag>
<parameter_value>Holiday_MemorialDay</parameter_value>
<parameter_description>The name of the output field which will store the date for Memorial Day</parameter_description>
</usage_parameter><usage_parameter><parameter_tag>OUTFIELD_INDEPENDENCEDAY</parameter_tag>
<parameter_value>Holiday_IndependenceDay</parameter_value>
<parameter_description>The name of the output field which will store the date for Independence Day</parameter_description>
</usage_parameter><usage_parameter><parameter_tag>OUTFIELD_LABORDAY</parameter_tag>
<parameter_value>Holiday_LaborDay</parameter_value>
<parameter_description>The name of the output field which will store the date for Labor Day</parameter_description>
</usage_parameter><usage_parameter><parameter_tag>OUTFIELD_COLUMBUSDAY</parameter_tag>
<parameter_value>Holiday_ColumbusDay</parameter_value>
<parameter_description>The name of the output field which will store the date for Columbus Day</parameter_description>
</usage_parameter><usage_parameter><parameter_tag>OUTFIELD_VETERANSDAY</parameter_tag>
<parameter_value>Holiday_VeteransDay</parameter_value>
<parameter_description>The name of the output field which will store the date for Veterans&#x27; Day</parameter_description>
</usage_parameter><usage_parameter><parameter_tag>OUTFIELD_THANKSGIVINGDAY</parameter_tag>
<parameter_value>Holiday_ThanksgivingDay</parameter_value>
<parameter_description>The name of the output field which will store the date for Thanksgiving Day</parameter_description>
</usage_parameter><usage_parameter><parameter_tag>OUTFIELD_DAYAFTERTHANKSGIVINGDAY</parameter_tag>
<parameter_value>Holiday_DayAfterThanksgivingDay</parameter_value>
<parameter_description>The name of the output field which will store the date for Day after Thanksgiving Day</parameter_description>
</usage_parameter><usage_parameter><parameter_tag>OUTFIELD_CHRISTMASDAY</parameter_tag>
<parameter_value>Holiday_ChristmasDay</parameter_value>
<parameter_description>The name of the output field which will store the date for Christmas Day</parameter_description>
</usage_parameter></usage_parameters>     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>256</xloc>
      <yloc>192</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Generate Years</name>
    <type>DataGrid</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <fields>
      <field>
        <name>YEAR</name>
        <type>Integer</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <set_empty_string>N</set_empty_string>
      </field>
    </fields>
    <data>
      <line> <item>2013</item> </line>
      <line> <item>2014</item> </line>
    </data>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>80</xloc>
      <yloc>192</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Row Normaliser</name>
    <type>Normaliser</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
   <typefield>Holiday Name</typefield>
    <fields>      <field>        <name>Holiday_NewYearsDay</name>
        <value>New Year&#x27;s Day</value>
        <norm>CalendarDate</norm>
        </field>      <field>        <name>Holiday_MartinLutherKingJrDay</name>
        <value>Martin Luther King Jr Day</value>
        <norm>CalendarDate</norm>
        </field>      <field>        <name>Holiday_PresidentsDay</name>
        <value>Presidents Day</value>
        <norm>CalendarDate</norm>
        </field>      <field>        <name>Holiday_MemorialDay</name>
        <value>Memorial Day</value>
        <norm>CalendarDate</norm>
        </field>      <field>        <name>Holiday_IndependenceDay</name>
        <value>Independence Day</value>
        <norm>CalendarDate</norm>
        </field>      <field>        <name>Holiday_LaborDay</name>
        <value>Labor Day</value>
        <norm>CalendarDate</norm>
        </field>      <field>        <name>Holiday_ColumbusDay</name>
        <value>Columbus Day</value>
        <norm>CalendarDate</norm>
        </field>      <field>        <name>Holiday_VeteransDay</name>
        <value>Veterans Day</value>
        <norm>CalendarDate</norm>
        </field>      <field>        <name>Holiday_ThanksgivingDay</name>
        <value>Thanksgiving Day</value>
        <norm>CalendarDate</norm>
        </field>      <field>        <name>Holiday_DayAfterThanksgivingDay</name>
        <value>Day After Thanksgiving Day</value>
        <norm>CalendarDate</norm>
        </field>      <field>        <name>Holiday_ChristmasDay</name>
        <value>Christmas Day</value>
        <norm>CalendarDate</norm>
        </field>      </fields>     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>416</xloc>
      <yloc>192</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step_error_handling>
  </step_error_handling>
   <slave-step-copy-partition-distribution>
</slave-step-copy-partition-distribution>
   <slave_transformation>N</slave_transformation>

</transformation>
